---
summary: äº†è§£å¦‚ä½•ä½¿ç”¨ `@adonisjs/i18n` åŒ…ä¸ºå¤šä¸ªåœ°åŒºå’Œè¯­è¨€åˆ›å»º Web åº”ç”¨ç¨‹åºã€‚
---

# å›½é™…åŒ–å’Œæœ¬åœ°åŒ–

å›½é™…åŒ–å’Œæœ¬åœ°åŒ–çš„ç›®çš„æ˜¯å¸®åŠ©æ‚¨ä¸ºå¤šä¸ªåœ°åŒºå’Œè¯­è¨€åˆ›å»º Web åº”ç”¨ç¨‹åºã€‚`@adonisjs/i18n` åŒ…æä¾›äº†å¯¹ i18nï¼ˆInternationalization çš„ç¼©å†™ï¼‰çš„æ”¯æŒã€‚

- **æœ¬åœ°åŒ–ï¼ˆLocalizationï¼‰** æ˜¯å°†åº”ç”¨ç¨‹åºçš„æ–‡æœ¬ç¿»è¯‘æˆå¤šç§è¯­è¨€çš„è¿‡ç¨‹ã€‚æ‚¨å¿…é¡»ä¸ºæ¯ç§è¯­è¨€ç¼–å†™å‰¯æœ¬ï¼Œå¹¶åœ¨ Edge æ¨¡æ¿ã€éªŒè¯é”™è¯¯æ¶ˆæ¯ä¸­å¼•ç”¨å®ƒä»¬ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ `i18n` APIã€‚

- **å›½é™…åŒ–ï¼ˆInternationalizationï¼‰** æ˜¯æ ¹æ®ç‰¹å®šåœ°åŒºæˆ–å›½å®¶æ ¼å¼åŒ– **æ—¥æœŸ**ã€**æ—¶é—´**ã€**æ•°å­—** ç­‰å€¼çš„è¿‡ç¨‹ã€‚

## å®‰è£…

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…å¹¶é…ç½®è¯¥åŒ…ï¼š

```sh
node ace add @adonisjs/i18n
```

:::disclosure{title="æŸ¥çœ‹ add å‘½ä»¤æ‰§è¡Œçš„æ­¥éª¤"}

1. ä½¿ç”¨æ£€æµ‹åˆ°çš„åŒ…ç®¡ç†å™¨å®‰è£… `@adonisjs/i18n` åŒ…ã€‚

2. åœ¨ `adonisrc.ts` æ–‡ä»¶ä¸­æ³¨å†Œä»¥ä¸‹æœåŠ¡æä¾›è€…ã€‚

    ```ts
    {
      providers: [
        // ...å…¶ä»–æä¾›è€…
        () => import('@adonisjs/i18n/i18n_provider')
      ]
    }
    ```

3. åˆ›å»º `config/i18n.ts` æ–‡ä»¶ã€‚

4. åœ¨ `middleware` ç›®å½•ä¸­åˆ›å»º `detect_user_locale_middleware`ã€‚

5. åœ¨ `start/kernel.ts` æ–‡ä»¶ä¸­æ³¨å†Œä»¥ä¸‹ä¸­é—´ä»¶ã€‚

    ```ts
    router.use([
      () => import('#middleware/detect_user_locale_middleware')
    ])
    ```

:::

## é…ç½®

i18n åŒ…çš„é…ç½®å­˜å‚¨åœ¨ `config/i18n.ts` æ–‡ä»¶ä¸­ã€‚

å¦è¯·å‚é˜…ï¼š[Config stub](https://github.com/adonisjs/i18n/blob/main/stubs/config/i18n.stub)

```ts
import app from '@adonisjs/core/services/app'
import { defineConfig, formatters, loaders } from '@adonisjs/i18n'

const i18nConfig = defineConfig({
  defaultLocale: 'en',
  formatter: formatters.icu(),

  loaders: [
    loaders.fs({
      location: app.languageFilesPath()
    })
  ],
})

export default i18nConfig
```

<dl>

<dt>

  formatter

</dt>

<dd>

å®šä¹‰ç”¨äºå­˜å‚¨ç¿»è¯‘çš„æ ¼å¼ã€‚AdonisJS æ”¯æŒ [ICU æ¶ˆæ¯æ ¼å¼](https://format-message.github.io/icu-message-format-for-translators/index.html)ã€‚

ICU æ¶ˆæ¯æ ¼å¼æ˜¯ä¸€ç§è¢«å¹¿æ³›æ¥å—çš„æ ‡å‡†ï¼Œè®¸å¤šç¿»è¯‘æœåŠ¡ï¼ˆå¦‚ Crowdin å’Œ Lokaliseï¼‰éƒ½æ”¯æŒå®ƒã€‚

æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ [æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯æ ¼å¼åŒ–å™¨](#creating-a-custom-translation-formatter)ã€‚

</dd>

<dt>

  defaultLocale

</dt>

<dd>

åº”ç”¨ç¨‹åºçš„é»˜è®¤åŒºåŸŸè®¾ç½®ã€‚å½“æ‚¨çš„åº”ç”¨ç¨‹åºä¸æ”¯æŒç”¨æˆ·è¯­è¨€æ—¶ï¼Œç¿»è¯‘å’Œå€¼æ ¼å¼åŒ–å°†å›é€€åˆ°æ­¤åŒºåŸŸè®¾ç½®ã€‚

</dd>

<dt id="config-fallback-locales">

  fallbackLocales

</dt>

<dd>

ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå®šä¹‰äº†ä¸€ç»„åŒºåŸŸè®¾ç½®åŠå…¶å¤‡ç”¨åŒºåŸŸè®¾ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºæ”¯æŒè¥¿ç­ç‰™è¯­ï¼Œæ‚¨å¯ä»¥å°†å…¶å®šä¹‰ä¸ºåŠ æ³°ç½—å°¼äºšè¯­çš„å¤‡ç”¨è¯­è¨€ã€‚

```ts
export default defineConfig({
  formatter: formatters.icu(),
  defaultLocale: 'en',
  // highlight-start
  fallbackLocales: {
    ca: 'es' // å½“ç”¨æˆ·è¯´åŠ æ³°ç½—å°¼äºšè¯­æ—¶æ˜¾ç¤ºè¥¿ç­ç‰™è¯­å†…å®¹
  }
  // highlight-end
})
```

</dd>

<dt>

  supportedLocales

</dt>

<dd>

æ‚¨çš„åº”ç”¨ç¨‹åºæ”¯æŒçš„åŒºåŸŸè®¾ç½®æ•°ç»„ã€‚

```ts
export default defineConfig({
  formatter: formatters.icu(),
  defaultLocale: 'en',
  // highlight-start
  supportedLocales: ['en', 'fr', 'it']
  // highlight-end
})
```

å¦‚æœæ‚¨æœªå®šä¹‰æ­¤å€¼ï¼Œæˆ‘ä»¬å°†ä»ç¿»è¯‘ä¸­æ¨æ–­ `supportedLocales`ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å®šä¹‰äº†è‹±è¯­ã€æ³•è¯­å’Œè¥¿ç­ç‰™è¯­çš„ç¿»è¯‘ï¼Œåˆ™ `supportedLocales` çš„å€¼å°†ä¸º `['en', 'es', 'fr']`ã€‚

</dd>

<dt>

  loaders

</dt>

<dd>

ç”¨äºåŠ è½½ç¿»è¯‘çš„åŠ è½½å™¨é›†åˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæ”¯æŒæ–‡ä»¶ç³»ç»ŸåŠ è½½å™¨ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ [æ·»åŠ è‡ªå®šä¹‰åŠ è½½å™¨](#creating-a-custom-translation-loader)ã€‚

</dd>

</dl>

## å­˜å‚¨ç¿»è¯‘

ç¿»è¯‘å­˜å‚¨åœ¨ `resources/lang` ç›®å½•ä¸­ï¼Œæ‚¨å¿…é¡»æ ¹æ® [IETF è¯­è¨€æ ‡ç­¾](https://en.wikipedia.org/wiki/IETF_language_tag) æ ¼å¼ä¸ºæ¯ç§è¯­è¨€åˆ›å»ºä¸€ä¸ªå­ç›®å½•ã€‚ä¾‹å¦‚ï¼š

```
resources
â”œâ”€â”€ lang
â”‚   â”œâ”€â”€ en
â”‚   â””â”€â”€ fr
```

æ‚¨å¯ä»¥é€šè¿‡åˆ›å»ºå¸¦æœ‰åœ°åŒºä»£ç çš„å­ç›®å½•æ¥ä¸ºç‰¹å®šåœ°åŒºå®šä¹‰ç¿»è¯‘ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸º **è‹±è¯­ï¼ˆå…¨çƒï¼‰**ã€**è‹±è¯­ï¼ˆç¾å›½ï¼‰** å’Œ **è‹±è¯­ï¼ˆè‹±å›½ï¼‰** å®šä¹‰äº†ä¸åŒçš„ç¿»è¯‘ã€‚

å½“æ‚¨åœ¨ç‰¹å®šåœ°åŒºç¿»è¯‘é›†ä¸­ç¼ºå°‘ç¿»è¯‘æ—¶ï¼ŒAdonisJS å°†è‡ªåŠ¨å›é€€åˆ° **è‹±è¯­ï¼ˆå…¨çƒï¼‰**ã€‚

å¦è¯·å‚é˜…ï¼š[ISO è¯­è¨€ä»£ç ](https://www.andiamo.co.uk/resources/iso-language-codes/)

```
resources
â”œâ”€â”€ lang
â”‚   â”œâ”€â”€ en
â”‚   â”œâ”€â”€ en-us
â”‚   â”œâ”€â”€ en-uk
```

### æ–‡ä»¶æ ¼å¼

ç¿»è¯‘å¿…é¡»å­˜å‚¨åœ¨ `.json` æˆ– `.yaml` æ–‡ä»¶ä¸­ã€‚æ‚¨å¯ä»¥åˆ›å»ºåµŒå¥—çš„ç›®å½•ç»“æ„ä»¥æ›´å¥½åœ°ç»„ç»‡æ–‡ä»¶ã€‚

```
resources
â”œâ”€â”€ lang
â”‚   â”œâ”€â”€ en
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â””â”€â”€ fr
â”‚       â””â”€â”€ messages.json
```

ç¿»è¯‘å¿…é¡»æŒ‰ç…§ [ICU æ¶ˆæ¯è¯­æ³•](https://format-message.github.io/icu-message-format-for-translators/index.html) è¿›è¡Œæ ¼å¼åŒ–ã€‚

```json
// title: resources/lang/en/messages.json
{
  "greeting": "Hello world"
}
```

```json
// title: resources/lang/fr/messages.json
{
  "greeting": "Bonjour le monde"
}
```

## è§£æç¿»è¯‘

åœ¨æŸ¥æ‰¾å’Œæ ¼å¼åŒ–ç¿»è¯‘ä¹‹å‰ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨ `i18nManager.locale` æ–¹æ³•ä¸ºç‰¹å®šåŒºåŸŸè®¾ç½®åˆ›å»ºä¸€ä¸ª [I18n ç±»](https://github.com/adonisjs/i18n/blob/main/src/i18n.ts) çš„å®ä¾‹ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

// è‹±è¯­çš„ I18n å®ä¾‹
const en = i18nManager.locale('en')

// æ³•è¯­çš„ I18n å®ä¾‹
const fr = i18nManager.locale('fr')
```

ä¸€æ—¦æ‚¨è·å¾—äº† `I18n` ç±»çš„å®ä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `.t` æ–¹æ³•æ¥æ ¼å¼åŒ–ç¿»è¯‘ã€‚

```ts
const i18n = i18nManager.locale('en')
i18n.t('messages.greeting') // Hello world
```

```ts
const i18n = i18nManager.locale('fr')
i18n.t('messages.greeting') // Bonjour le monde
```

### å¤‡ç”¨åŒºåŸŸè®¾ç½®

æ¯ä¸ªå®ä¾‹éƒ½åŸºäº [config.fallbackLocales](#config-fallback-locales) é›†åˆé¢„é…ç½®äº†ä¸€ä¸ªå¤‡ç”¨è¯­è¨€ã€‚å½“ä¸»è¦è¯­è¨€ç¼ºå°‘ç¿»è¯‘æ—¶ï¼Œä¼šä½¿ç”¨å¤‡ç”¨è¯­è¨€ã€‚

```ts
export default defineConfig({
  fallbackLocales: {
    'de-CH': 'de',
    'fr-CH': 'fr'
  }
})
```

```ts
const i18n = i18nManager.locale('de-CH')
i18n.fallbackLocale // deï¼ˆä½¿ç”¨å¤‡ç”¨é›†åˆï¼‰
```

```ts
const i18n = i18nManager.locale('fr-CH')
i18n.fallbackLocale // frï¼ˆä½¿ç”¨å¤‡ç”¨é›†åˆï¼‰
```

```ts
const i18n = i18nManager.locale('en')
i18n.fallbackLocale // enï¼ˆä½¿ç”¨é»˜è®¤åŒºåŸŸè®¾ç½®ï¼‰
```

### ç¼ºå°‘çš„ç¿»è¯‘

å¦‚æœä¸»è¦åŒºåŸŸè®¾ç½®å’Œå¤‡ç”¨åŒºåŸŸè®¾ç½®ä¸­éƒ½ç¼ºå°‘ç¿»è¯‘ï¼Œ`.t` æ–¹æ³•å°†è¿”å›æ ¼å¼å¦‚ä¸‹çš„é”™è¯¯å­—ç¬¦ä¸²ã€‚

```ts
const i18n = i18nManager.locale('en')

i18n.t('messages.hero_title')
// translation missing: en, messages.hero_title
```

æ‚¨å¯ä»¥é€šè¿‡å°†å¤‡é€‰å€¼ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ¥æ›¿æ¢æ­¤æ¶ˆæ¯ä¸ºå…¶ä»–æ¶ˆæ¯æˆ–ç©ºå­—ç¬¦ä¸²ã€‚

```ts
const fallbackValue = ''
i18n.t('messages.hero_title', fallbackValue)
// è¾“å‡º: ''
```

æ‚¨è¿˜å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å…¨å±€è®¡ç®—å¤‡é€‰å€¼ã€‚`fallback` æ–¹æ³•æ¥æ”¶ç¿»è¯‘è·¯å¾„ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥æ”¶åŒºåŸŸè®¾ç½®ä»£ç ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚ç¡®ä¿å§‹ç»ˆè¿”å›å­—ç¬¦ä¸²å€¼ã€‚

```ts
import { defineConfig } from '@adonisjs/i18n'

export default defineConfig({
  fallback: (identifier, locale) => {
    return ''
  },
})
```

## åœ¨ HTTP è¯·æ±‚æœŸé—´æ£€æµ‹ç”¨æˆ·åŒºåŸŸè®¾ç½®

åœ¨åˆå§‹è®¾ç½®æœŸé—´ï¼Œæˆ‘ä»¬åœ¨ `./app/middleware` ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª `detect_user_locale_middleware.ts` æ–‡ä»¶ã€‚ä¸­é—´ä»¶æ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚

- ä½¿ç”¨ [`Accept-language` header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language) æ£€æµ‹è¯·æ±‚çš„åŒºåŸŸè®¾ç½®ã€‚

- ä¸ºè¯·æ±‚åŒºåŸŸè®¾ç½®åˆ›å»ºä¸€ä¸ª `I18n` ç±»çš„å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ [HTTP Context](../concepts/http_context.md) å°†å…¶ä¸è¯·æ±‚çš„å…¶ä½™éƒ¨åˆ†å…±äº«ã€‚

- ä½œä¸ºå…¨å±€ `i18n` å±æ€§ï¼Œä¸ Edge æ¨¡æ¿å…±äº«åŒä¸€å®ä¾‹ã€‚

- æœ€åï¼ŒæŒ‚é’©åˆ° [Request validator](../basics/validation.md#the-requestvalidateusing-method)ï¼Œå¹¶ä½¿ç”¨ç¿»è¯‘æ–‡ä»¶æä¾›éªŒè¯æ¶ˆæ¯ã€‚

å¦‚æœæ­¤ä¸­é—´ä»¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œæ‚¨å¯ä»¥åœ¨æ§åˆ¶å™¨å’Œ Edge æ¨¡æ¿ä¸­æŒ‰å¦‚ä¸‹æ–¹å¼ç¿»è¯‘æ¶ˆæ¯ã€‚

```ts
import { HttpContext } from '@adonisjs/core/http'

export default class PostsController {
  async store({ i18n, session }: HttpContext) {
    session.flash('success', {
      message: i18n.t('post.created')
    })
  }
}
```

```edge
<h1> {{ t('messages.heroTitle') }} </h1>
```

### æ›´æ”¹ç”¨æˆ·è¯­è¨€æ£€æµ‹ä»£ç 

ç”±äº `detect_user_locale_middleware` æ˜¯æ‚¨åº”ç”¨ç¨‹åºä»£ç åº“çš„ä¸€éƒ¨åˆ†ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹ `getRequestLocale` æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰é€»è¾‘æ¥æŸ¥æ‰¾ç”¨æˆ·è¯­è¨€ã€‚

## ç¿»è¯‘éªŒè¯æ¶ˆæ¯

`detect_user_locale_middleware` æŒ‚é’©åˆ° [Request validator](../basics/validation.md#the-requestvalidateusing-method)ï¼Œå¹¶ä½¿ç”¨ç¿»è¯‘æ–‡ä»¶æä¾›éªŒè¯æ¶ˆæ¯ã€‚

```ts
export default class DetectUserLocaleMiddleware {
  static {
    // highlight-start
    RequestValidator.messagesProvider = (ctx) => {
      return ctx.i18n.createMessagesProvider()
    }
    // highlight-end
  }
}
```

ç¿»è¯‘å¿…é¡»å­˜å‚¨åœ¨ `validator.json` æ–‡ä»¶ä¸­çš„ `shared` é”®ä¸‹ã€‚å¯ä»¥ä¸ºéªŒè¯è§„åˆ™æˆ– `field + rule` ç»„åˆå®šä¹‰éªŒè¯æ¶ˆæ¯ã€‚

```json
// title: resources/lang/en/validator.json
{
  "shared": {
    "fields": {
      "first_name": "first name"
    },
    "messages": {
      "required": "Enter {field}",
      "username.required": "Choose a username for your account",
      "email": "The email must be valid"
    }
  }
}
```

```json
// title: resources/lang/fr/validator.json
{
  "shared": {
    "fields": {
      "first_name": "PrÃ©nom"
    },
    "messages": {
      "required": "Remplisser le champ {field}",
      "username.required": "Choissisez un nom d'utilisateur pour votre compte",
      "email": "L'email doit Ãªtre valide"
    }
  }
}
```

### ç›´æ¥ä½¿ç”¨ VineJS è¿›è¡Œç¿»è¯‘

åœ¨ HTTP è¯·æ±‚æœŸé—´ï¼Œ`detect_user_locale_middleware` æŒ‚é’©åˆ°è¯·æ±‚éªŒè¯å™¨ï¼Œå¹¶æ³¨å†Œä¸€ä¸ª [custom messages provider](https://vinejs.dev/docs/custom_error_messages#registering-messages-provider)ï¼Œä»¥ä»ç¿»è¯‘æ–‡ä»¶ä¸­æŸ¥æ‰¾éªŒè¯é”™è¯¯ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨åœ¨ HTTP è¯·æ±‚ä¹‹å¤–ä½¿ç”¨ VineJSï¼Œä¾‹å¦‚åœ¨ Ace å‘½ä»¤æˆ–é˜Ÿåˆ—ä½œä¸šä¸­ï¼Œåˆ™åœ¨è°ƒç”¨ `validator.validate` æ–¹æ³•æ—¶ï¼Œå¿…é¡»æ˜¾å¼æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰æ¶ˆæ¯æä¾›è€…ã€‚

```ts
import { createJobValidator } from '#validators/jobs'
import i18nManager from '@adonisjs/i18n/services/main'

/**
 * è·å–ç‰¹å®šåŒºåŸŸè®¾ç½®çš„ i18n å®ä¾‹
 */
const i18n = i18nManager.locale('fr')

await createJobValidator.validate(data, {
  /**
   * æ³¨å†Œç”¨äºç¿»è¯‘çš„
   * æ¶ˆæ¯æä¾›è€…
   */
  // highlight-start
  messagesProvider: i18n.createMessagesProvider()
  // highlight-end
})
```

## ICU æ¶ˆæ¯æ ¼å¼

### æ’å€¼

ICU æ¶ˆæ¯è¯­æ³•ä½¿ç”¨å•ä¸ªå¤§æ‹¬å·æ¥å¼•ç”¨åŠ¨æ€å€¼ã€‚ä¾‹å¦‚ï¼š

:::note
ICU æ¶ˆæ¯è¯­æ³• [ä¸æ”¯æŒåµŒå¥—æ•°æ®é›†](https://github.com/formatjs/formatjs/pull/2039#issuecomment-951550150)ï¼Œå› æ­¤ï¼Œåœ¨æ’å€¼æ—¶ï¼Œæ‚¨åªèƒ½ä»å¹³é¢å¯¹è±¡ä¸­è®¿é—®å±æ€§ã€‚
:::

```json
{
  "greeting": "Hello { username }"
}
```

```edge
{{ t('messages.greeting', { username: 'Virk' }) }}
```

æ‚¨è¿˜å¯ä»¥åœ¨æ¶ˆæ¯ä¸­ç¼–å†™ HTMLã€‚ä½†æ˜¯ï¼Œåœ¨ Edge æ¨¡æ¿ä¸­ï¼Œè¯·ä½¿ç”¨ä¸‰ä¸ª [å¤§æ‹¬å·](https://edgejs.dev/docs/interpolation#escaped-html-output) æ¥æ¸²æŸ“ HTMLï¼Œè€Œä¸å¯¹å…¶è¿›è¡Œè½¬ä¹‰ã€‚

```json
{
  "greeting": "<p> Hello { username } </p>"
}
```

```edge
{{{ t('messages.greeting', { username: 'Virk' }) }}}
```

### æ•°å­—æ ¼å¼

æ‚¨å¯ä»¥åœ¨ç¿»è¯‘æ¶ˆæ¯ä¸­ä½¿ç”¨ `{key, type, format}` è¯­æ³•æ¥æ ¼å¼åŒ–æ•°å€¼ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼š

- `amount` æ˜¯è¿è¡Œæ—¶å€¼ã€‚
- `number` æ˜¯æ ¼å¼åŒ–ç±»å‹ã€‚
- `::currency/USD` æ˜¯å¸¦æœ‰ [æ•°å­—éª¨æ¶](https://unicode-org.github.io/icu/userguide/format_parse/numbers/skeletons.html#overview) çš„è´§å¸æ ¼å¼ã€‚

```json
{
  "bagel_price": "The price of this bagel is {amount, number, ::currency/USD}"
}
```

```edge
{{ t('bagel_price', { amount: 2.49 }) }}
```

```
The price of this bagel is $2.49
```

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `number` æ ¼å¼ä¸ä¸åŒæ ¼å¼æ ·å¼å’Œæ•°å­—éª¨æ¶çš„ç¤ºä¾‹ã€‚

```
Length of the pole: {price, number, ::measure-unit/length-meter}
```

```
Account balance: {price, number, ::currency/USD compact-long}
```

### æ—¥æœŸ/æ—¶é—´æ ¼å¼

æ‚¨å¯ä»¥ä½¿ç”¨ `{key, type, format}` è¯­æ³•æ¥æ ¼å¼åŒ– [Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date) å®ä¾‹æˆ– [luxon DateTime](https://moment.github.io/luxon/api-docs/index.html) å®ä¾‹ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼š

- `expectedDate` æ˜¯è¿è¡Œæ—¶å€¼ã€‚
- `date` æ˜¯æ ¼å¼åŒ–ç±»å‹ã€‚
- `medium` æ˜¯æ—¥æœŸæ ¼å¼ã€‚

```json
{
  "shipment_update": "Your package will arrive on {expectedDate, date, medium}"
}
```

```edge
{{ t('shipment_update', { expectedDate: luxonDateTime }) }}
```

```
Your package will arrive on Oct 16, 2023
```

æ‚¨å¯ä»¥ä½¿ç”¨ `time` æ ¼å¼å°†å€¼æ ¼å¼åŒ–ä¸ºæ—¶é—´ã€‚

```json
{
  "appointment": "You have an appointment today at {appointmentAt, time, ::h:m a}"
}
```

```txt
You have an appointment today at 2:48 PM
```

ICU æä¾›äº† [å¤šç§æ¨¡å¼](https://unicode-org.github.io/icu/userguide/format_parse/datetime/#date-field-symbol-table) æ¥å®šåˆ¶æ—¥æœŸæ—¶é—´æ ¼å¼ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰è¿™äº›æ¨¡å¼éƒ½å¯é€šè¿‡ ECMA402 çš„ Intl API ä½¿ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»…æ”¯æŒä»¥ä¸‹æ¨¡å¼ã€‚

| ç¬¦å· | æè¿°                                             |
|--------|--------------------------------------------------|
| `G`    | å¹´ä»£æ ‡è¯†ç¬¦                                       |
| `y`    | å¹´                                               |
| `M`    | å¹´ä¸­çš„æœˆä»½                                       |
| `L`    | å¹´ä¸­ç‹¬ç«‹æœˆä»½                                     |
| `d`    | æœˆä¸­çš„å¤©æ•°                                       |
| `E`    | ä¸€å‘¨ä¸­çš„å¤©æ•°                                     |
| `e`    | æœ¬åœ°ä¸€å‘¨ä¸­çš„å¤©æ•° e..eee ä¸æ”¯æŒ                   |
| `c`    | æœ¬åœ°ç‹¬ç«‹ä¸€å‘¨ä¸­çš„å¤©æ•° c..ccc ä¸æ”¯æŒ               |
| `a`    | ä¸Šåˆ/ä¸‹åˆæ ‡è®°                                    |
| `h`    | å°æ—¶ [1-12]                                      |
| `H`    | å°æ—¶ [0-23]                                      |
| `K`    | å°æ—¶ [0-11]                                      |
| `k`    | å°æ—¶ [1-24]                                      |
| `m`    | åˆ†é’Ÿ                                             |
| `s`    | ç§’                                               |
| `z`    | æ—¶åŒº                                             |

### å¤æ•°è§„åˆ™

ICU æ¶ˆæ¯è¯­æ³•æ”¯æŒåœ¨æ¶ˆæ¯ä¸­å®šä¹‰å¤æ•°è§„åˆ™ã€‚ä¾‹å¦‚ï¼š

:::note

åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ YAML è€Œä¸æ˜¯ JSONï¼Œå› ä¸ºåœ¨ YAML ä¸­ç¼–å†™å¤šè¡Œæ–‡æœ¬æ›´å®¹æ˜“ã€‚

:::

```yaml
cart_summary:
  "You have {itemsCount, plural,
    =0 {no items}
    one {1 item}
    other {# items}
  } in your cart"
```

```edge
{{ t('messages.cart_summary', { itemsCount: 1 }) }}
```

```
æ‚¨çš„è´­ç‰©è½¦ä¸­æœ‰ 1 ä»¶å•†å“
```

`#` æ˜¯ä¸€ä¸ªç‰¹æ®Šæ ‡è®°ï¼Œç”¨ä½œæ•°å€¼çš„å ä½ç¬¦ã€‚å®ƒå°†æ ¼å¼åŒ–ä¸º `{key, number}`ã€‚

```edge
{{ t('messages.cart_summary', { itemsCount: 1000 }) }}

{{-- Output --}}
{{-- æ‚¨çš„è´­ç‰©è½¦ä¸­æœ‰ 1,000 ä»¶å•†å“ --}}
```

å¤æ•°è§„åˆ™ä½¿ç”¨ `{key, plural, matches}` è¯­æ³•ã€‚`matches` æ˜¯ä¸ä»¥ä¸‹å¤æ•°ç±»åˆ«ä¹‹ä¸€åŒ¹é…çš„å­—é¢å€¼ã€‚

| ç±»åˆ«   | æè¿°                                                                                                                                                                                                                             |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `zero`   | è¯¥ç±»åˆ«ç”¨äºè¯­æ³•ä¸“é—¨é’ˆå¯¹é›¶ä¸ªé¡¹ç›®çš„è¯­è¨€ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­å’Œæ‹‰è„±ç»´äºšè¯­ï¼‰                                                                                                                                                               |
| `one`    | è¯¥ç±»åˆ«ç”¨äºè¯­æ³•ä¸“é—¨é’ˆå¯¹ä¸€ä¸ªé¡¹ç›®çš„è¯­è¨€ã€‚è®¸å¤šè¯­è¨€ä½¿ç”¨è¿™ä¸ªå¤æ•°ç±»åˆ«ï¼Œä½†å¹¶éæ‰€æœ‰è¯­è¨€éƒ½å¦‚æ­¤ã€‚ï¼ˆè®¸å¤šæµè¡Œçš„äºšæ´²è¯­è¨€ï¼Œå¦‚ä¸­æ–‡å’Œæ—¥è¯­ï¼Œä¸ä½¿ç”¨æ­¤ç±»åˆ«ã€‚ï¼‰                                                                                         |
| `two`    | è¯¥ç±»åˆ«ç”¨äºè¯­æ³•ä¸“é—¨é’ˆå¯¹ä¸¤ä¸ªé¡¹ç›®çš„è¯­è¨€ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­å’Œå¨å°”å£«è¯­ã€‚ï¼‰                                                                                                                                                               |
| `few`    | è¯¥ç±»åˆ«ç”¨äºè¯­æ³•ä¸“é—¨é’ˆå¯¹å°‘é‡é¡¹ç›®çš„è¯­è¨€ã€‚å¯¹äºæŸäº›è¯­è¨€ï¼Œè¿™é€‚ç”¨äº 2-4 ä¸ªé¡¹ç›®ï¼Œå¯¹äºæŸäº›è¯­è¨€é€‚ç”¨äº 3-10 ä¸ªé¡¹ç›®ï¼Œè€Œå…¶ä»–è¯­è¨€åˆ™æœ‰æ›´å¤æ‚çš„è§„åˆ™ã€‚                                                                                             |
| `many`   | è¯¥ç±»åˆ«ç”¨äºè¯­æ³•ä¸“é—¨é’ˆå¯¹è¾ƒå¤§æ•°é‡é¡¹ç›®çš„è¯­è¨€ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­ã€æ³¢å…°è¯­å’Œä¿„è¯­ã€‚ï¼‰                                                                                                                                                       |
| `other`  | å¦‚æœå€¼ä¸åŒ¹é…å…¶ä»–å¤æ•°ç±»åˆ«ï¼Œåˆ™ä½¿ç”¨è¯¥ç±»åˆ«ã€‚è¯·æ³¨æ„ï¼Œå¯¹äºå…·æœ‰ç®€å•â€œå•æ•°â€ä¸â€œå¤æ•°â€äºŒåˆ†æ³•çš„è¯­è¨€ï¼ˆå¦‚è‹±è¯­ï¼‰ï¼Œæ­¤ç±»åˆ«ç”¨äºâ€œå¤æ•°â€ã€‚                                                                                                             |
| `=value` | è¿™ç”¨äºåŒ¹é…ç‰¹å®šå€¼ï¼Œè€Œä¸è€ƒè™‘å½“å‰è¯­è¨€ç¯å¢ƒçš„å¤æ•°ç±»åˆ«ã€‚                                                                                                                                                                               |

> *è¡¨æ ¼å†…å®¹å‚è€ƒè‡ª [formatjs.io](https://formatjs.io/docs/core-concepts/icu-syntax/#plural-format)*

### é€‰æ‹©

`select` æ ¼å¼å…è®¸æ‚¨é€šè¿‡å°†å€¼ä¸å¤šä¸ªé€‰é¡¹ä¹‹ä¸€åŒ¹é…æ¥é€‰æ‹©è¾“å‡ºã€‚æ’°å†™æ€§åˆ«ç‰¹å®šçš„æ–‡æœ¬æ˜¯ `select` æ ¼å¼çš„ä¸€ä¸ªç»ä½³ç¤ºä¾‹ã€‚

```yaml
// title: Yaml
auto_reply:
  "{gender, select,
    male {He}
    female {She}
    other {They}
  } will respond shortly."
```

```edge
{{ t('messages.auto_reply', { gender: 'female' }) }}
```

```
å¥¹å¾ˆå¿«å°±ä¼šå›å¤ã€‚
```

### é€‰æ‹©åºæ•°

`select ordinal` æ ¼å¼å…è®¸æ‚¨æ ¹æ®åºæ•°å¤æ•°åŒ–è§„åˆ™é€‰æ‹©è¾“å‡ºã€‚è¯¥æ ¼å¼ä¸ `select` æ ¼å¼ç›¸ä¼¼ã€‚ä½†æ˜¯ï¼Œå€¼è¢«æ˜ å°„åˆ°åºæ•°å¤æ•°ç±»åˆ«ã€‚

```yaml
anniversary_greeting:
  "It's my {years, selectordinal,
    one {#st}
    two {#nd}
    few {#rd}
    other {#th}
  } anniversary"
```

```edge
{{ t('messages.anniversary_greeting', { years: 2 }) }}
```

```txt
è¿™æ˜¯æˆ‘çš„ç¬¬äºŒä¸ªå‘¨å¹´çºªå¿µæ—¥
```

é€‰æ‹©åºæ•°æ ¼å¼ä½¿ç”¨ `{key, selectordinal, matches}` è¯­æ³•ã€‚åŒ¹é…é¡¹æ˜¯å­—é¢å€¼ï¼Œå¹¶ä¸ä»¥ä¸‹å¤æ•°ç±»åˆ«ä¹‹ä¸€åŒ¹é…ã€‚

| ç±»åˆ«     | æè¿°                                                                                                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `zero`   | æ­¤ç±»åˆ«ç”¨äºä¸“é—¨ä¸ºé›¶ä¸ªé¡¹ç›®è®¾è®¡çš„è¯­æ³•ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­å’Œæ‹‰è„±ç»´äºšè¯­ã€‚ï¼‰                                                                                                                                                                         |
| `one`    | æ­¤ç±»åˆ«ç”¨äºä¸“é—¨ä¸ºä¸€é¡¹è®¾è®¡çš„è¯­æ³•ã€‚è®¸å¤šè¯­è¨€ï¼ˆä½†å¹¶éæ‰€æœ‰è¯­è¨€ï¼‰ä½¿ç”¨æ­¤å¤æ•°ç±»åˆ«ã€‚ï¼ˆè®¸å¤šæµè¡Œçš„äºšæ´²è¯­è¨€ï¼Œå¦‚ä¸­æ–‡å’Œæ—¥è¯­ï¼Œä¸ä½¿ç”¨æ­¤ç±»åˆ«ã€‚ï¼‰                                                                                                             |
| `two`    | æ­¤ç±»åˆ«ç”¨äºä¸“é—¨ä¸ºä¸¤ä¸ªé¡¹ç›®è®¾è®¡çš„è¯­æ³•ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­å’Œå¨å°”å£«è¯­ã€‚ï¼‰                                                                                                                                                                           |
| `few`    | æ­¤ç±»åˆ«ç”¨äºä¸“é—¨ä¸ºå°‘é‡é¡¹ç›®è®¾è®¡çš„è¯­æ³•ã€‚åœ¨æŸäº›è¯­è¨€ä¸­ï¼Œæ­¤ç±»åˆ«ç”¨äº2-4ä¸ªé¡¹ç›®ï¼Œåœ¨æŸäº›è¯­è¨€ä¸­ç”¨äº3-10ä¸ªé¡¹ç›®ï¼Œè€Œå…¶ä»–è¯­è¨€åˆ™æœ‰æ›´å¤æ‚çš„è§„åˆ™ã€‚                                                                                                            |
| `many`   | æ­¤ç±»åˆ«ç”¨äºä¸“é—¨ä¸ºè¾ƒå¤§æ•°é‡çš„é¡¹ç›®è®¾è®¡çš„è¯­æ³•ã€‚ï¼ˆä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­ã€æ³¢å…°è¯­å’Œä¿„è¯­ã€‚ï¼‰                                                                                                                                                                 |
| `other`  | å¦‚æœå€¼ä¸åŒ¹é…å…¶ä»–å¤æ•°ç±»åˆ«ï¼Œåˆ™ä½¿ç”¨æ­¤ç±»åˆ«ã€‚è¯·æ³¨æ„ï¼Œå¯¹äºå…·æœ‰ç®€å•çš„â€œå•æ•°â€ä¸â€œå¤æ•°â€äºŒåˆ†æ³•çš„è¯­è¨€ï¼ˆå¦‚è‹±è¯­ï¼‰ï¼Œæ­¤ç±»åˆ«ç”¨äºâ€œå¤æ•°â€ã€‚                                                                                                                     |
| `=value` | æ­¤é€‰é¡¹ç”¨äºåŒ¹é…ç‰¹å®šå€¼ï¼Œè€Œä¸è€ƒè™‘å½“å‰è¯­è¨€ç¯å¢ƒçš„å¤æ•°ç±»åˆ«ã€‚                                                                                                                                                                                     |

> *è¡¨æ ¼å†…å®¹å¼•ç”¨è‡ª [formatjs.io](https://formatjs.io/docs/core-concepts/icu-syntax/#selectordinal-format)*

## æ ¼å¼åŒ–å€¼

ä»¥ä¸‹æ–¹æ³•åº•å±‚ä½¿ç”¨ [Node.js Intl API](https://nodejs.org/dist/latest/docs/api/intl.html)ï¼Œä½†æ€§èƒ½æ›´å¥½ã€‚[æŸ¥çœ‹åŸºå‡†æµ‹è¯•](https://github.com/poppinss/intl-formatter?tab=readme-ov-file#benchmarks)

### formatNumber

ä½¿ç”¨ `Intl.NumberFormat` ç±»æ ¼å¼åŒ–æ•°å€¼ã€‚æ‚¨å¯ä»¥ä¼ é€’ä»¥ä¸‹å‚æ•°ã€‚

1. è¦æ ¼å¼åŒ–çš„å€¼ã€‚
2. å¯é€‰çš„ [`options` å¯¹è±¡](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options)ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatNumber(123456.789, {
    maximumSignificantDigits: 3
  })
```

### formatCurrency

ä½¿ç”¨ `Intl.NumberFormat` ç±»å°†æ•°å€¼æ ¼å¼åŒ–ä¸ºè´§å¸ã€‚`formatCurrency` æ–¹æ³•éšå¼å®šä¹‰äº† `style = currency` é€‰é¡¹ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatCurrency(200, {
    currency: 'USD'
  })
```

### formatDate

ä½¿ç”¨ `Intl.DateTimeFormat` ç±»æ ¼å¼åŒ–æ—¥æœŸæˆ– luxon æ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚æ‚¨å¯ä»¥ä¼ é€’ä»¥ä¸‹å‚æ•°ã€‚

1. è¦æ ¼å¼åŒ–çš„å€¼ã€‚å¯ä»¥æ˜¯ [Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date) å¯¹è±¡æˆ– [luxon DateTime](https://moment.github.io/luxon/api-docs/index.html) å¯¹è±¡ã€‚
2. å¯é€‰çš„ [`options` å¯¹è±¡](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat/DateTimeFormat#options)ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'
import { DateTime } from 'luxon'

i18nManager
  .locale('en')
  .formatDate(new Date(), {
    dateStyle: 'long'
  })

// æ ¼å¼åŒ– luxon æ—¥æœŸæ—¶é—´å®ä¾‹
i18nManager
  .locale('en')
  .formatDate(DateTime.local(), {
    dateStyle: 'long'
  })
```

### formatTime

ä½¿ç”¨ `Intl.DateTimeFormat` ç±»å°†æ—¥æœŸå€¼æ ¼å¼åŒ–ä¸ºæ—¶é—´å­—ç¬¦ä¸²ã€‚`formatTime` æ–¹æ³•éšå¼å®šä¹‰äº† `timeStyle = medium` é€‰é¡¹ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatTime(new Date())
```

### formatRelativeTime

`formatRelativeTime` æ–¹æ³•ä½¿ç”¨ `Intl.RelativeTimeFormat` ç±»å°†å€¼æ ¼å¼åŒ–ä¸ºç›¸å¯¹æ—¶é—´è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•æ¥å—ä»¥ä¸‹å‚æ•°ã€‚

- è¦æ ¼å¼åŒ–çš„å€¼ã€‚
- æ ¼å¼åŒ–å•ä½ã€‚é™¤äº† [å®˜æ–¹æ”¯æŒçš„å•ä½](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/RelativeTimeFormat/format) å¤–ï¼Œæˆ‘ä»¬è¿˜æ”¯æŒé¢å¤–çš„ `auto` å•ä½ã€‚
- å¯é€‰çš„ [options](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/RelativeTimeFormat/RelativeTimeFormat#options) å¯¹è±¡ã€‚

```ts
import { DateTime } from 'luxon'
import i18nManager from '@adonisjs/i18n/services/main'

const luxonDate = DateTime.local().plus({ hours: 2 })

i18nManager
  .locale('en')
  .formatRelativeTime(luxonDate, 'hours')
```

å°†å•ä½çš„å€¼è®¾ç½®ä¸º `auto` ä»¥æ˜¾ç¤ºæœ€ä½³åŒ¹é…å•ä½çš„å·®å¼‚ã€‚

```ts
const luxonDate = DateTime.local().plus({ hours: 2 })

I18n
  .locale('en')
  .formatRelativeTime(luxonDate, 'auto')

// In 2 hours ğŸ‘ˆ
```

```ts
const luxonDate = DateTime.local().plus({ hours: 200 })

I18n
  .locale('en')
  .formatRelativeTime(luxonDate, 'auto')

// In 8 days ğŸ‘ˆ
```

### formatPlural

ä½¿ç”¨ `Intl.PluralRules` ç±»æŸ¥æ‰¾æ•°å­—çš„å¤æ•°ç±»åˆ«ã€‚æ‚¨å¯ä»¥ä¼ é€’ä»¥ä¸‹å‚æ•°ã€‚

1. è¦æŸ¥æ‰¾å¤æ•°ç±»åˆ«çš„æ•°å€¼ã€‚
2. å¯é€‰çš„ [options](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/PluralRules/PluralRules#options) å¯¹è±¡ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager.i18nManager('en').formatPlural(0)
// other

i18nManager.i18nManager('en').formatPlural(1)
// one

i18nManager.i18nManager('en').formatPlural(2)
// other
```

### formatList
ä½¿ç”¨ `Intl.ListFormat` ç±»å°†å­—ç¬¦ä¸²æ•°ç»„æ ¼å¼åŒ–ä¸ºå¥å­ã€‚æ‚¨å¯ä»¥ä¼ é€’ä»¥ä¸‹å‚æ•°ã€‚

1. è¦æ ¼å¼åŒ–çš„å€¼ã€‚
2. å¯é€‰çš„ [options](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/ListFormat/ListFormat#options) å¯¹è±¡ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatList(['Me', 'myself', 'I'], { type: 'conjunction' })

// Me, myself and I
```

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatList(['5 hours', '3 minutes'], { type: 'unit' })

// 5 hours, 3 minutes
```

### formatDisplayNames

ä½¿ç”¨ `Intl.DisplayNames` ç±»å°† `currency`ï¼ˆè´§å¸ï¼‰ã€`language`ï¼ˆè¯­è¨€ï¼‰ã€`region`ï¼ˆåœ°åŒºï¼‰å’Œ `calendar`ï¼ˆæ—¥å†ï¼‰ä»£ç æ ¼å¼åŒ–ä¸ºå®ƒä»¬çš„æ˜¾ç¤ºåç§°ã€‚æ‚¨å¯ä»¥ä¼ é€’ä»¥ä¸‹å‚æ•°ã€‚

1. è¦æ ¼å¼åŒ–çš„ä»£ç ã€‚æ ¹æ®æ ¼å¼åŒ– `type`ï¼ˆç±»å‹ï¼‰çš„ä¸åŒï¼Œ[`code` çš„å€¼](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DisplayNames/of#code) ä¼šæœ‰æ‰€ä¸åŒã€‚
2. [Options](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DisplayNames/DisplayNames#options) å¯¹è±¡ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatDisplayNames('INR', { type: 'currency' })

// Indian Rupee
```

```ts
import i18nManager from '@adonisjs/i18n/services/main'

i18nManager
  .locale('en')
  .formatDisplayNames('en-US', { type: 'language' })

// American English
```

## é…ç½® i18n Ally VSCode æ‰©å±•

VSCode çš„ [i18n Ally](https://marketplace.visualstudio.com/items?itemName=Lokalise.i18n-ally) æ‰©å±•æä¾›äº†ä¸€ä¸ªä¼˜ç§€çš„å·¥ä½œæµç¨‹ï¼Œç”¨äºåœ¨ä»£ç ç¼–è¾‘å™¨ä¸­ **å­˜å‚¨**ã€**æ£€æŸ¥**å’Œ **å¼•ç”¨** ç¿»è¯‘ã€‚

è¦ä½¿è¯¥æ‰©å±•ä¸ AdonisJS æ— ç¼åä½œï¼Œæ‚¨å¿…é¡»åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.vscode` ç›®å½•ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ã€‚

```sh
mkdir .vscode

touch .vscode/i18n-ally-custom-framework.yml
touch .vscode/settings.json
```

å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶/ç²˜è´´åˆ° `settings.json` æ–‡ä»¶ä¸­ã€‚

```json
// title: .vscode/settings.json
{
  "i18n-ally.localesPaths": [
    "resources/lang"
  ],
  "i18n-ally.keystyle": "nested",
  "i18n-ally.namespace": true,
  "i18n-ally.editor.preferEditor": true,
  "i18n-ally.refactor.templates": [
    {
      "templates": [
        "{{ t('{key}'{args}) }}"
      ],
      "include": [
        "**/*.edge",
      ],
    },
  ]
}
```

å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶/ç²˜è´´åˆ° `.vscode/i18n-ally-custom-framework.yml` æ–‡ä»¶ä¸­ã€‚

```yaml
// title: .vscode/i18n-ally-custom-framework.yml
languageIds:
  - edge
usageMatchRegex:
  - "[^\\w\\d]t\\(['\"`]({key})['\"`]"
sortKeys: true
```

## ç›‘å¬ç¼ºå¤±ç¿»è¯‘äº‹ä»¶

æ‚¨å¯ä»¥ç›‘å¬ `i18n:missing:translation` äº‹ä»¶ï¼Œä»¥è·å–åº”ç”¨ç¨‹åºä¸­ç¼ºå¤±ç¿»è¯‘çš„é€šçŸ¥ã€‚

```ts
import emitter from '@adonisjs/core/services/emitter'

emitter.on('i18n:missing:translation', function (event) {
  console.log(event.identifier)
  console.log(event.hasFallback)
  console.log(event.locale)
})
```

## å¼ºåˆ¶é‡æ–°åŠ è½½ç¿»è¯‘

`@adonisjs/i18n` åŒ…åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶è¯»å–ç¿»è¯‘æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨å†…å­˜ä¸­ä»¥ä¾¿å¿«é€Ÿè®¿é—®ã€‚

ç„¶è€Œï¼Œå¦‚æœæ‚¨åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¿®æ”¹äº†ç¿»è¯‘æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `reloadTranslations` æ–¹æ³•åˆ·æ–°å†…å­˜ç¼“å­˜ã€‚

```ts
import i18nManager from '@adonisjs/i18n/services/main'

await i18nManager.reloadTranslations()
```

## åˆ›å»ºè‡ªå®šä¹‰ç¿»è¯‘åŠ è½½å™¨

ç¿»è¯‘åŠ è½½å™¨è´Ÿè´£ä»æŒä¹…å­˜å‚¨ä¸­åŠ è½½ç¿»è¯‘ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–‡ä»¶ç³»ç»ŸåŠ è½½å™¨ï¼Œå¹¶æä¾›äº†ä¸€ä¸ª API æ¥æ³¨å†Œè‡ªå®šä¹‰åŠ è½½å™¨ã€‚

åŠ è½½å™¨å¿…é¡»å®ç° [TranslationsLoaderContract](https://github.com/adonisjs/i18n/blob/main/src/types.ts#L73) æ¥å£ï¼Œå¹¶å®šä¹‰ `load` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„å¯¹è±¡ã€‚é”®æ˜¯åŒºåŸŸè®¾ç½®ä»£ç ï¼Œå€¼æ˜¯åŒ…å«ç¿»è¯‘åˆ—è¡¨çš„æ‰å¹³å¯¹è±¡ã€‚

```ts
import type {
  LoaderFactory,
  TranslationsLoaderContract,
} from '@adonisjs/i18n/types'

/**
 * é…ç½®çš„ç±»å‹
 */
export type DbLoaderConfig = {
  connection: string
  tableName: string
}

/**
 * åŠ è½½å™¨å®ç°
 */
export class DbLoader implements TranslationsLoaderContract {
  constructor(public config: DbLoaderConfig) {
  }

  async load() {
    return {
      en: {
        'messages.greeting': 'Hello world',
      },
      fr: {
        'messages.greeting': 'Bonjour le monde',
      }
    }
  }
}

/**
 * å·¥å‚å‡½æ•°ï¼Œç”¨äºåœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨åŠ è½½å™¨ã€‚
 */
export function dbLoader(config: DbLoaderConfig): LoaderFactory {
  return () => {
    return new DbLoader(config)
  }
}
```

åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯¼å‡ºäº†ä»¥ä¸‹å€¼ã€‚

- `DbLoaderConfig`ï¼šæ‚¨å¸Œæœ›æ¥å—çš„é…ç½®çš„ TypeScript ç±»å‹ã€‚
- `DbLoader`ï¼šä½œä¸ºç±»çš„åŠ è½½å™¨å®ç°ã€‚å®ƒå¿…é¡»éµå¾ª `TranslationsLoaderContract` æ¥å£ã€‚
- `dbLoader`ï¼šæœ€åï¼Œä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œç”¨äºåœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨åŠ è½½å™¨ã€‚

### ä½¿ç”¨åŠ è½½å™¨

åˆ›å»ºåŠ è½½å™¨åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `dbLoader` å·¥å‚å‡½æ•°åœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨å®ƒã€‚

```ts
import { defineConfig } from '@adonisjs/i18n'
import { dbLoader } from 'my-custom-package'

const i18nConfig = defineConfig({
  loaders: [
    dbLoader({
      connection: 'pg',
      tableName: 'translations'
    })
  ]
})
```

## åˆ›å»ºè‡ªå®šä¹‰ç¿»è¯‘æ ¼å¼åŒ–å™¨

ç¿»è¯‘æ ¼å¼åŒ–å™¨è´Ÿè´£æ ¹æ®ç‰¹å®šæ ¼å¼æ ¼å¼åŒ–ç¿»è¯‘ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª ICU æ¶ˆæ¯è¯­æ³•çš„å®ç°ï¼Œå¹¶æä¾›äº†é¢å¤–çš„ API æ¥æ³¨å†Œè‡ªå®šä¹‰æ ¼å¼åŒ–å™¨ã€‚

æ ¼å¼åŒ–å™¨å¿…é¡»å®ç° [TranslationsFormatterContract](https://github.com/adonisjs/i18n/blob/main/src/types.ts#L54) æ¥å£ï¼Œå¹¶å®šä¹‰ `format` æ–¹æ³•æ¥æ ¼å¼åŒ–ç¿»è¯‘æ¶ˆæ¯ã€‚

```ts
import type {
  FormatterFactory,
  TranslationsLoaderContract,
} from '@adonisjs/i18n/types'

/**
 * æ ¼å¼åŒ–å™¨å®ç°
 */
export class FluentFormatter implements TranslationsFormatterContract {
  format(
    message: string,
    locale: string,
    data?: Record<string, any>
  ): string {
    // è¿”å›æ ¼å¼åŒ–åçš„å€¼
  }
}

/**
 * å·¥å‚å‡½æ•°ï¼Œç”¨äºåœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨æ ¼å¼åŒ–å™¨ã€‚
 */
export function fluentFormatter(): FormatterFactory {
  return () => {
    return new FluentFormatter()
  }
}
```

### ä½¿ç”¨æ ¼å¼åŒ–å™¨

åˆ›å»ºæ ¼å¼åŒ–å™¨åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `fluentFormatter` å·¥å‚å‡½æ•°åœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨å®ƒã€‚

```ts
import { defineConfig } from '@adonisjs/i18n'
import { fluentFormatter } from 'my-custom-package'

const i18nConfig = defineConfig({
  formatter: fluentFormatter()
})
```
